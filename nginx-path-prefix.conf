# Nginx配置 - 路径前缀方案
# 访问地址: https://www.bizops.top/investment/
# 此配置不会影响现有服务，可以安全添加到现有Nginx配置中

# 在现有的 server 块中添加以下 location 配置
# 不要替换现有的 location / 配置！

location /investment/ {
    proxy_pass http://127.0.0.1:8082/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_cache_bypass $http_upgrade;
    
    # 重写路径，移除 /investment 前缀
    rewrite ^/investment/(.*)$ /$1 break;
    
    # 超时设置
    proxy_connect_timeout 60s;
    proxy_send_timeout 60s;
    proxy_read_timeout 60s;
}

# Next.js静态资源
location /investment/_next/ {
    proxy_pass http://127.0.0.1:8082/_next/;
    proxy_cache_valid 200 60m;
    add_header Cache-Control "public, max-age=3600";
}

# 注意：
# 1. 此配置需要配合修改后的 next.config.js（使用basePath）
# 2. 添加到现有server块中，不要替换现有的 location / 配置
# 3. 现有服务继续在根路径 / 下运行，不受影响

