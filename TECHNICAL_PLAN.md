# 投资分析工具技术方案

## 一、业务模块划分

### 1. 用户管理模块
- **功能**：用户登录、权限管理、角色区分（分析师/投资经理/管理层）
- **权限控制**：
  - 分析师：可上传报告、创建提示词、生成分析报告
  - 投资经理：可查看所有报告、编辑分析报告、确认报告
  - 管理层：可查看所有报告、评分评语、查看提示词策略、数据统计

### 2. 报告管理模块
- **功能**：
  - 报告上传（PDF、XLSX、CSV等格式）
  - 企业私有库报告指向（对接投资管理平台）
  - 报告列表展示
  - 报告详情查看
  - 报告分类与标签（按行业、公司、报告类型）
- **数据模型**：
  - 报告基本信息（标题、来源、上传时间、上传人）
  - 报告元数据（文件大小、页数、格式）
  - 报告分类标签（行业、公司、报告类型）

### 3. 提示词工厂模块（Prompt Factory）
- **功能**：
  - 提示词模板管理
  - 结构化提示词构建器
  - 关键指标选择（CAGR、TAM、Burn Rate、EBITDA等）
  - 分析焦点选择（竞争格局、财务分析、风险评估等）
  - 上下文模式选择（Discovery/Financial）
  - 高价值模板保存与复用
- **数据模型**：
  - 提示词模板（名称、描述、分类、成功率）
  - 提示词策略（指标组合、分析焦点、上下文模式）
  - 模板评分与使用统计

### 4. AI分析模块
- **功能**：
  - LLM模型选择（OpenAI/Gemini/元宝/豆包/千问）
  - 自动模型匹配（根据报告内容）
  - 分析任务执行
  - 分析进度跟踪
  - 分析结果预览
- **技术要点**：
  - 支持多模型切换
  - 流式响应处理
  - 错误重试机制
  - 成本控制

### 5. 报告生成与编辑模块
- **功能**：
  - 分析报告自动生成
  - 报告结构化展示（执行摘要、关键指标、风险分析等）
  - 报告编辑与微调
  - 报告重新生成
  - 报告确认与保存
  - 报告版本管理
- **数据模型**：
  - 分析报告（标题、内容、生成时间、使用的模型、提示词策略）
  - 报告版本历史
  - 报告状态（草稿/待确认/已确认）

### 6. 知识库模块（Knowledge Hub）
- **功能**：
  - 投资判断经验积累（用于Sourcing、验证投资假设、寻找赛道机会）
  - 项目延续性要点（用于DD和IC Memo）
  - 知识检索与关联
  - 知识标签与分类
  - 知识图谱可视化
- **数据模型**：
  - 知识条目（标题、内容、来源报告、标签、创建时间）
  - 知识关联关系
  - 知识使用统计

### 7. 仪表盘模块（Dashboard）
- **功能**：
  - 报告统计（总数、增长率、质量评分）
  - AI效率统计（时间节省、使用率）
  - 团队能力积累可视化（按行业、按分析师）
  - AI模型性能统计
  - 最近研究报告列表
  - 投资能力积累趋势

### 8. 报告评分与评语模块
- **功能**：
  - 管理层对报告评分（1-10分）
  - 评语添加
  - 评分历史查看
  - 质量趋势分析

### 9. 投资组合管理模块（可选）
- **功能**：
  - 投资组合概览
  - 项目跟踪
  - 投资决策记录

## 二、技术路线图

### Phase 1: 基础架构搭建（2-3周）
1. **前端基础**
   - Next.js 14+ 项目初始化
   - TypeScript 配置
   - Tailwind CSS 样式系统
   - 项目目录结构设计
   - 基础组件库搭建

2. **状态管理**
   - Zustand 状态管理配置
   - API 客户端封装（Axios）
   - 错误处理机制

3. **UI组件库**
   - 基础组件（Button、Input、Card等）
   - 布局组件（Sidebar、Header、Content）
   - 数据展示组件（Table、Chart、Metric Card）

### Phase 2: 核心功能开发（4-5周）
1. **用户认证与权限**
   - 登录/登出
   - 角色权限控制
   - 路由守卫

2. **报告管理**
   - 文件上传组件
   - 报告列表页面
   - 报告详情页面
   - 报告分类与筛选

3. **提示词工厂**
   - 提示词构建器UI
   - 模板管理
   - 模板保存与加载

4. **AI分析工作区**
   - 模型选择器
   - 分析任务创建
   - 分析结果展示
   - 报告编辑界面

### Phase 3: 高级功能开发（3-4周）
1. **知识库**
   - 知识条目管理
   - 知识检索
   - 知识图谱可视化

2. **仪表盘**
   - 数据统计卡片
   - 图表可视化
   - 实时数据更新

3. **报告评分系统**
   - 评分界面
   - 评语功能
   - 评分历史

### Phase 4: 优化与集成（2-3周）
1. **性能优化**
   - 代码分割
   - 懒加载
   - 缓存策略

2. **外部系统集成**
   - 投资管理平台对接
   - 文件存储服务集成

3. **多语言支持**
   - i18n 配置
   - 语言切换

4. **测试与部署**
   - 单元测试
   - E2E测试
   - 部署配置

## 三、技术栈选型

### 前端框架
- **Next.js 14+**：React框架，支持SSR、路由、API路由
- **React 18+**：UI库
- **TypeScript**：类型安全

### 样式方案
- **Tailwind CSS**：原子化CSS框架
- **shadcn/ui**：高质量组件库（可选）

### 状态管理
- **Zustand**：轻量级状态管理
- **React Query**：服务端状态管理（可选）

### 数据可视化
- **Recharts**：图表库
- **D3.js**：复杂可视化（可选）

### 表格组件
- **TanStack Table**：强大的表格组件

### 文件处理
- **react-dropzone**：文件上传
- **pdf-lib**：PDF处理（前端预览）

### 其他工具
- **Axios**：HTTP客户端
- **date-fns**：日期处理
- **clsx**：类名工具

## 四、数据模型设计

### 核心实体
1. **User**：用户信息、角色、权限
2. **Report**：报告基本信息、文件信息、分类标签
3. **PromptTemplate**：提示词模板、策略配置
4. **AnalysisTask**：分析任务、状态、使用的模型和提示词
5. **AnalysisReport**：分析报告、内容、版本、状态
6. **Knowledge**：知识条目、标签、关联关系
7. **Rating**：评分、评语、评分人、时间

## 五、API设计（前端视角）

### 报告管理
- `GET /api/reports`：获取报告列表
- `POST /api/reports`：上传报告
- `GET /api/reports/:id`：获取报告详情
- `DELETE /api/reports/:id`：删除报告

### 提示词工厂
- `GET /api/prompts`：获取提示词模板列表
- `POST /api/prompts`：创建提示词模板
- `GET /api/prompts/:id`：获取模板详情
- `PUT /api/prompts/:id`：更新模板

### AI分析
- `POST /api/analysis`：创建分析任务
- `GET /api/analysis/:id`：获取分析任务状态
- `GET /api/analysis/:id/result`：获取分析结果

### 知识库
- `GET /api/knowledge`：获取知识条目
- `POST /api/knowledge`：创建知识条目
- `GET /api/knowledge/graph`：获取知识图谱数据

### 仪表盘
- `GET /api/dashboard/stats`：获取统计数据
- `GET /api/dashboard/recent`：获取最近活动

### 评分
- `POST /api/reports/:id/rating`：提交评分
- `GET /api/reports/:id/ratings`：获取评分历史

## 六、安全考虑

1. **文件上传安全**
   - 文件类型验证
   - 文件大小限制
   - 病毒扫描（后端）

2. **数据安全**
   - 敏感数据加密
   - API认证（JWT）
   - 权限验证

3. **LLM调用安全**
   - API密钥管理
   - 请求限流
   - 成本控制

## 七、部署方案

1. **前端部署**
   - Vercel/Netlify（推荐）
   - 自建服务器（Docker）

2. **环境配置**
   - 开发环境
   - 测试环境
   - 生产环境

3. **CI/CD**
   - GitHub Actions
   - 自动化测试
   - 自动化部署

